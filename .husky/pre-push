#!/usr/bin/env sh
. "$(dirname "$0")/_/husky.sh"

# Get current branch name
branch=$(git symbolic-ref --short HEAD)

# Allow main/master branches
if echo "$branch" | grep -Eq '^(main|master)$'; then
  exit 0
fi

# Enforce format: INITIALS/ISSUEID-description OR INITIALS/OOS-description
# Allow both uppercase and lowercase in description
if ! echo "$branch" | grep -Eq '^[A-Z]{2,5}/([0-9]+|OOS)-[a-zA-Z0-9-]+$'; then
  echo "‚ùå Invalid branch name: '$branch'"
  echo "üîí Use format: INITIALS/ISSUEID-description OR INITIALS/OOS-description"
  echo ""
  echo "üìã Examples:"
  echo "   JB/12-add-api"
  echo "   TK/OOS-deploying-app"
  echo "   FE/123-CICD-pipeline"
  echo ""
  echo "üí° To rename your branch locally, run:"
  echo "   git branch -m NEW_BRANCH_NAME"
  echo ""
  echo "üõ† Example:"
  echo "   git branch -m JB/12-add-login"
  exit 1
fi

echo "‚úÖ Branch name '$branch' looks good."